<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://sdk.mercadopago.com/js/v2"></script>
</head>
<body>
    <form id="paymentForm">
  <input type="text" id="cardNumber" placeholder="Número do cartão" />
  <input type="text" id="cardExpirationMonth" placeholder="Mês de expiração (MM)" />
  <input type="text" id="cardExpirationYear" placeholder="Ano de expiração (YY)" />
  <input type="text" id="cardholderName" placeholder="Nome no cartão" />
  <input type="text" id="securityCode" placeholder="Código de segurança" />
  <input type="email" id="email" placeholder="Email" />
  <button type="submit">Pagar</button>
</form>

<script>
    const mp = new MercadoPago('APP_USR-d957fa62-7a15-4f87-9f41-bc16b8fdf357', {
  locale: 'pt-BR' // ou outro idioma
});

    const paymentForm = document.getElementById('paymentForm');

paymentForm.addEventListener('submit', function(event) {
  event.preventDefault();

  const cardData = {
    cardNumber: document.getElementById('cardNumber').value,
    cardExpirationMonth: document.getElementById('cardExpirationMonth').value,
    cardExpirationYear: document.getElementById('cardExpirationYear').value,
    cardholderName: document.getElementById('cardholderName').value,
    securityCode: document.getElementById('securityCode').value,
  };

  mp.card.createToken(cardData).then(function(response) {
    if (response.error) {
      alert('Erro ao gerar token: ' + response.error.message);
      return;
    }

    const cardToken = response.id; // Token gerado

    const email = document.getElementById('email').value;

    // Agora envie o token e o email para o backend via fetch/AJAX
    fetch('apimercadopago.php', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        token: cardToken,
        email: email,
        amount: 1000.00 // valor do pagamento, pode ser dinâmico
      })
    })
    .then(res => res.json())
    .then(data => {
      alert('Pagamento realizado com sucesso! Order ID: ' + data.order_id);
    })
    .catch(err => {
      alert('Erro no pagamento: ' + err.message);
    });

  });
});
</script>
</body>
</html>